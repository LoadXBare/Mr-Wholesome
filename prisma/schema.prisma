// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- USER MODELS --- //

model Birthday {
  birthdayID String @id @default(uuid())
  userID     String @unique
  date       String
}

// --- GUILD MODELS --- //
model GuildConfig {
  guildID                 String   @id
  cmdIgnoredChannelIDs    String[] @default([])
  eventIgnoredChannelIDs  String[] @default([])
  rankedIgnoredChannelIDs String[] @default([])
}

model Ban {
  banID    String  @id @default(uuid())
  guildID  String
  authorID String
  bannedID String
  date     BigInt
  reason   String
  unbanned Boolean @default(false)
}

model Rank {
  userID      String
  guildID     String
  xp          Int     @default(0)
  xpLevel     Int     @default(0)
  levelNotifs Boolean @default(true)
  credits     Int     @default(0)

  @@id([userID, guildID])
}

model Ticket {
  ticketID      String      @id @default(uuid())
  ticketPanelID String
  authorID      String
  open          Boolean     @default(true)
  TicketPanel   TicketPanel @relation(fields: [ticketPanelID], references: [ticketPanelID], onDelete: Cascade)
}

model TicketPanel {
  ticketPanelID   String   @id @default(uuid())
  guildID         String
  categoryID      String
  panelEmbedJSON  Json
  ticketEmbedJSON Json
  name            String   @unique
  tickets         Ticket[]
}

model Warning {
  warningID String @id @default(uuid())
  guildID   String
  authorID  String
  warnedID  String
  reason    String
  date      BigInt
}

model Notes {
  noteID    String @id @default(uuid())
  authorID  String
  watchedID String
  guildID   String
  date      BigInt
  noteText  String
}

model MemberStats {
  userID             String
  guildID            String
  messageCount       Int
  messageCountByHour Json

  @@id([userID, guildID])
}
